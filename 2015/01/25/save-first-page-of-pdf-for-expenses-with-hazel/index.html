<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#ff6b00" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#ff6b00" media="(prefers-color-scheme: dark)">

<link rel="me" href="https://mastodon.social/@rjames">
<meta name="fediverse:creator" content="@rjames@mastodon.social">

<meta name="author" content="Ryan M">
<meta name="description" content="Posts and writings by Ryan M">
    <link rel="alternate" title="ryanmo.co JSON Feed" type="application/json" href="feed.json" />
    <link href="http://feedpress.me/ryanmoco" type="application/rss+xml" rel="alternate" title="ryanmo.co Full RSS Feed" />

    <title>Save First Page of PDF for Expenses with Hazel - ryanmo.co</title>
    <link rel="stylesheet" href="https://ryanmo.co/theme/css/style.css">
</head>
<body>
    <!-- Fixed navigation banner -->
    <div class="nav-banner">
        <div class="nav-container">
            <h2 class="site-title"><a href="https://ryanmo.co/">ryanmo.co</a></h2>
            <nav class="nav-links">
                <a href="https://ryanmo.co/">Home</a>
                <a href="https://ryanmo.co/about">About</a>
            </nav>
        </div>
    </div>

    <header>
    </header>

    <main>
<article>
    <h1>Save First Page of PDF for Expenses with Hazel</h1>
    <div class="article-meta">
        <time datetime="2015-01-25T12:46:00-08:00">2015-01-25</time>
        by Ryan M
        in <a href="https://ryanmo.co/category/tech">Tech</a>
    </div>
    <p>Once a month I have to submit my Verizon bill as an expense. The process of getting the PDF of the bill and then modifying it turned out to be a big pain by first reminding my mom to send the bill<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>, saving the first page and then submitting it for reimbursement. Turns out that Hazel can take care of everything beyond the actual submission.</p>

<p>I'm fine with reminding my mom to put the PDF in Dropbox, but I then have to check back every-so-often to see if she's actually done it. I've created a rule now that will check for any files in our shared Verizon Bill folder and if Hazel hasn't seen it before, it will send me a push notification with Pushover.</p>
<p><img alt="pushover_hazel_verizon" src="https://ryanmo.co/posts/Tech/2015-01-25/pushover_hazel_verizon.png" /></p>
<p>I then wrote a handy little Applescript based on PDFPenPro's default script called Split PDFs that will take the first page of a PDF and save it to a new file. I differentiate the files by just adding "SINGLE PAGE" to the filename</p>
<div class="codehilite"><pre><span></span><code><span class="k">set</span> <span class="nv">basePath</span> <span class="k">to</span> <span class="s2">&quot;/path/to/verizon/folder&quot;</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;PDFpenPro&quot;</span>
    <span class="nb">open</span> <span class="nv">theFile</span> <span class="k">as</span> <span class="nv">alias</span>
    <span class="k">set</span> <span class="nv">originalDoc</span> <span class="k">to</span> <span class="na">document</span> <span class="mi">1</span>
    <span class="k">set</span> <span class="nv">docName</span> <span class="k">to</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">originalDoc</span>

    <span class="k">if</span> <span class="nv">docName</span> <span class="ow">ends with</span> <span class="s2">&quot;.pdf&quot;</span> <span class="k">then</span>
        <span class="k">set</span> <span class="nv">docNameLength</span> <span class="k">to</span> <span class="p">(</span><span class="nv">length</span> <span class="k">of</span> <span class="nv">docName</span><span class="p">)</span>
        <span class="k">set</span> <span class="nv">docName</span> <span class="k">to</span> <span class="p">(</span><span class="nb">characters</span> <span class="mi">1</span> <span class="nb">thru</span> <span class="p">(</span><span class="nv">docNameLength</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="k">of</span> <span class="nv">docName</span> <span class="k">as </span><span class="nc">string</span><span class="p">)</span>
    <span class="k">end</span> <span class="k">if</span>


    <span class="k">set</span> <span class="nv">newDoc</span> <span class="k">to</span> <span class="nb">make</span> <span class="nb">new</span> <span class="na">document</span>
    <span class="k">set</span> <span class="nv">savePath</span> <span class="k">to</span> <span class="p">((</span><span class="nv">basePath</span> <span class="k">as</span> <span class="na">rich text</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nv">docName</span> <span class="o">&amp;</span> <span class="s2">&quot; SINGLE PAGE&quot;</span> <span class="o">&amp;</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>

    <span class="nb">copy</span> <span class="nv">page</span> <span class="mi">1</span> <span class="k">of</span> <span class="nv">originalDoc</span> <span class="k">to</span> <span class="k">end</span> <span class="k">of</span> <span class="nv">pages</span> <span class="k">of</span> <span class="nv">newDoc</span>

    <span class="nv">save</span> <span class="nv">newDoc</span> <span class="k">in</span> <span class="nv">POSIX</span> <span class="nv">file</span> <span class="nv">savePath</span>

    <span class="nb">quit</span>
<span class="k">end</span> <span class="k">tell</span>
</code></pre></div>

<p>Finally, so that I don't forget to submit the expense, I have one final Applescript that creates a todo item in Omnifocus based on David Spark's post <a href="http://macsparky.com/blog/2012/8/applescript-omnifocus-tasks">here</a></p>
<div class="codehilite"><pre><span></span><code><span class="k">set</span> <span class="nv">theDate</span> <span class="k">to</span> <span class="nb">current date</span>
<span class="k">set</span> <span class="nv">deferDate</span> <span class="k">to</span> <span class="p">(</span><span class="nb">current date</span><span class="p">)</span>
<span class="k">set</span> <span class="nv">dueDate</span> <span class="k">to</span> <span class="p">(</span><span class="nb">current date</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="nb">days</span><span class="p">)</span>
<span class="k">set</span> <span class="nv">theTask</span> <span class="k">to</span> <span class="s2">&quot;Expense Verizon Bill&quot;</span>
<span class="k">set</span> <span class="nv">theNote</span> <span class="k">to</span> <span class="nv">theFile</span>

<span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;OmniFocus&quot;</span>
    <span class="k">tell</span> <span class="nb">front</span> <span class="na">document</span>
        <span class="k">set</span> <span class="nv">theContext</span> <span class="k">to</span> <span class="nb">first</span> <span class="nv">flattened</span> <span class="na">context</span> <span class="nb">where</span> <span class="k">its</span> <span class="na">name</span> <span class="o">=</span> <span class="s2">&quot;A Context&quot;</span>
        <span class="k">set</span> <span class="nv">theProject</span> <span class="k">to</span> <span class="nb">first</span> <span class="nv">flattened</span> <span class="nv">project</span> <span class="nb">where</span> <span class="k">its</span> <span class="na">name</span> <span class="o">=</span> <span class="s2">&quot;Expenses&quot;</span>
        <span class="k">tell</span> <span class="nv">theProject</span> <span class="k">to</span> <span class="nb">make</span> <span class="nb">new</span> <span class="nv">task</span> <span class="nv">with</span> <span class="na">properties</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span><span class="nv">theTask</span><span class="p">,</span> <span class="nv">note</span><span class="p">:</span><span class="nv">theNote</span><span class="p">,</span> <span class="na">context</span><span class="p">:</span><span class="nv">theContext</span><span class="p">,</span> <span class="nv">defer</span> <span class="nv">date</span><span class="p">:</span><span class="nv">deferDate</span><span class="p">,</span> <span class="nv">due</span> <span class="nv">date</span><span class="p">:</span><span class="nv">dueDate</span><span class="p">}</span>
    <span class="k">end</span> <span class="k">tell</span>
<span class="k">end</span> <span class="k">tell</span>
</code></pre></div>

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>We're on a family plan&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
</article>
    </main>

    <footer>
        <p>&copy;  Ryan M. Powered by <a href="https://getpelican.com">Pelican</a></p>
    </footer>
</body>
</html>