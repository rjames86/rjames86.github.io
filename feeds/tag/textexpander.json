{
    "author": {
        "name": "Ryan M"
    },
    "favicon": "https://ryanmo.co/images/favicon.png",
    "feed_url": "https://ryanmo.co/feeds/tag/textexpander.json",
    "home_page_url": "https://ryanmo.co",
    "items": [
        {
            "id": "https://ryanmo.co/2016/04/10/moving-textexpander-snippets-to-keyboard-maestro",
            "url": "https://ryanmo.co/2016/04/10/moving-textexpander-snippets-to-keyboard-maestro",
            "title": "Moving TextExpander Snippets to Keyboard Maestro",
            "content_html": "<p>I've been a long time TextExpander user. I use it every day for simple things like pasting my contact info or shortening urls using bit.ly. There are plenty of articles out there arguing for and against TextExpander's new subscription model. I support their decision but I can't justify $50 a year's worth of value and so I'm moving all of my snippets to Keyboard Maestro.</p>\n\n\n<p>I had been thinking this weekend whether it would be worth the time to try to migrate all my snippets to Keyboard Maestro. Browsing my Twitter feed, it looked as though <a href=\"http://leancrew.com/all-this/2016/04/importing-textexpander-snippets-to-keyboard-maestro/\">Dr. Drang</a> had beat me to it. Unfortunately he didn't do the work I was hoping I wouldn't have to do, and so I sat down to see how hard it would be to convert snippets to macros. Turns out...not that hard.</p>\n<p>Here are the requirements for running this script:</p>\n<ul>\n<li>Python 2.7 (I didn't test Python 3.x). If you're running an older/newer version of Python, you should be able to replace <code>python</code> with <code>/usr/bin/python2.7</code> when running the script.</li>\n<li>TextExpander 5.x. If you are running version 4, your settings will be named Settings.textexpander instead of Settings.textexpandersettings.</li>\n</ul>\n<p>I've made some decisions as to how I want the snippets to work. Notably</p>\n<ul>\n<li>Pasting instead of typing. Typing is too slow.</li>\n<li>Delete the last clipboard item, since it was the text that was just pasted. </li>\n<li>Groups remain the same. If you used groups in TextExpander, they show up as \"Snippets - <group name>\" in Keyboard Maestro. </li>\n</ul>\n<p>There are a few things that I haven't yet solved. Some I might in the future, others maybe not:</p>\n<ul>\n<li>I didn't test Applescript since I didn't have any. Please let me know if that one breaks.</li>\n<li>Placeholders and variables from TextExpander won't work. This means if you had a \"today's date\" snippet, you'll need to rewrite that one<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup>.</li>\n<li>Custom delimiters. I haven't really figured out if there's a way to do this. I've tried changing Keyboard Maestro to only fire on delimiters, but it doesn't seem to work. If anyone figured this out, please let me know.</li>\n</ul>\n<p>Before running, be sure to update the variable <code>TEXTEXPANDER_PATH</code> to wherever your TextExpander settings file lives. To run, it's as simple as navigating to the location where the script lives in Terminal.app and entering</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"err\">python TE.py</span>\n</code></pre></div>\n\n<p>You'll now have a folder on your Desktop named 'TextExpander_to_KeyboardMaestro' with all of your groups.</p>\n<hr />\n<p><em>Update 2016-04-12</em></p>\n<p>Big thanks to NW in the comments for helping me debug a few things.</p>\n<p>I've removed the import of <code>enum</code>. I had forgotten that wasn't a standard library in Python 2.7. I also added a list of requirements above for running the script.</p>\n<p><em>Update 2016-04-14</em></p>\n<p>Also thanks to Dr Drang for posting about the script! I've made some updates and also put up a repo for those who would like to make edits and pull requests.</p>\n<p>Updates are</p>\n<ul>\n<li>Optional prefix if you want to change that up when moving to Keyboard Maestro</li>\n<li>Insert text by typing OR pasting</li>\n<li>Added some instruction on how to edit the variables to have the script do what you want</li>\n</ul>\n<p>The repo is now hosted at <a href=\"https://github.com/rjames86/textexpander_to_keyboardmaestro\">https://github.com/rjames86/textexpander_to_keyboardmaestro</a></p>\n<hr />\n<p>You can download the script on Github <a href=\"https://raw.githubusercontent.com/rjames86/textexpander_to_keyboardmaestro/master/TE.py\">here</a></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"nn\">plistlib</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"kn\">import</span> <span class=\"nn\">glob</span>\n\n<span class=\"sd\">&#39;&#39;&#39;</span>\n<span class=\"sd\">This script will parse through all group_*.xml files within your TextExpander folder.</span>\n<span class=\"sd\">Anything marked as Plain Text, Shell Script or JavaScript should be converted into</span>\n<span class=\"sd\">Keyboard Maestro groups with the same title and abbreviation.</span>\n\n<span class=\"sd\">All new KM Macro files will be saved to the Desktop.</span>\n\n<span class=\"sd\">&#39;&#39;&#39;</span>\n\n<span class=\"c1\"># Modify this area to customize how the script will run</span>\n\n<span class=\"c1\"># Change this path to where ever your TextExander Settings live</span>\n<span class=\"n\">HOME</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">expanduser</span><span class=\"p\">(</span><span class=\"s1\">&#39;~&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">TEXTEXPANDER_PATH</span> <span class=\"o\">=</span> <span class=\"n\">HOME</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;/Dropbox/TextExpander/Settings.textexpandersettings&#39;</span>\n<span class=\"n\">SAVE_PATH</span> <span class=\"o\">=</span> <span class=\"n\">HOME</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;/Desktop/TextExpander_to_KeyboardMaestro&#39;</span>\n\n<span class=\"c1\"># Change this if you&#39;d like to change your snippets when importing to Keyboard Maestro</span>\n<span class=\"c1\"># If your snippet is ttest, you can make it ;;ttest by changing the variable to &#39;;;&#39;</span>\n<span class=\"n\">OPTIONAL_NEW_PREFIX</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;&#39;</span>\n\n<span class=\"c1\"># Change this if you want the snippet to inserted by typing or pasting</span>\n<span class=\"c1\"># Remember it MUST be &#39;paste&#39; or &#39;type&#39; or the script will fail</span>\n<span class=\"n\">PASTE_OR_TYPE</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;paste&#39;</span> <span class=\"c1\"># &#39;type&#39;</span>\n\n\n\n\n<span class=\"c1\">############</span>\n\n<span class=\"c1\"># Edit below at your own risk</span>\n\n<span class=\"c1\">############</span>\n\n<span class=\"n\">snippet_types</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;plaintext&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;applescript&#39;</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;shell&#39;</span><span class=\"p\">:</span> <span class=\"mi\">3</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;javascript&#39;</span><span class=\"p\">:</span> <span class=\"mi\">4</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">snippet_types_to_values</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">((</span><span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">value</span> <span class=\"ow\">in</span> <span class=\"n\">snippet_types</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">())</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">KeyboardMaestroMacros</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">macro_by_name</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">macro_name</span><span class=\"p\">,</span> <span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">macro_name</span><span class=\"p\">)(</span><span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">javascript</span><span class=\"p\">(</span><span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;Activate&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Normal&#39;</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;Macros&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"p\">{</span><span class=\"s1\">&#39;Actions&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                    <span class=\"p\">{</span><span class=\"s1\">&#39;DisplayKind&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_paste_or_type</span><span class=\"p\">(),</span>\n                     <span class=\"s1\">&#39;IncludeStdErr&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ExecuteJavaScriptForAutomation&#39;</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;Path&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;Text&#39;</span><span class=\"p\">:</span> <span class=\"n\">text</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TimeOutAbortsMacro&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TrimResults&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TrimResultsNew&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;UseText&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">},</span> <span class=\"p\">{</span>\n                        <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;DeletePastClipboard&#39;</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;PastExpression&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;0&#39;</span><span class=\"p\">}</span>\n                    <span class=\"p\">],</span>\n                 <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482018934.65354</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;ModificationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482018953.856014</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"n\">name</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;Triggers&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"s1\">&#39;Case&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Exact&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;DiacriticalsMatter&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroTriggerType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;OnlyAfterWordBreak&#39;</span><span class=\"p\">:</span> <span class=\"bp\">False</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;SimulateDeletes&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_abbreviation</span><span class=\"p\">(</span><span class=\"n\">abbreviation</span><span class=\"p\">)}]}</span>\n            <span class=\"p\">],</span>\n            <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Snippet - </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">group_name</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">applescript</span><span class=\"p\">(</span><span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;Activate&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Normal&#39;</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;Macros&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"p\">{</span><span class=\"s1\">&#39;Actions&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                    <span class=\"p\">{</span><span class=\"s1\">&#39;DisplayKind&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_paste_or_type</span><span class=\"p\">(),</span>\n                     <span class=\"s1\">&#39;IncludeStdErr&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ExecuteAppleScript&#39;</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;Path&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;Text&#39;</span><span class=\"p\">:</span> <span class=\"n\">text</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TimeOutAbortsMacro&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TrimResults&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;TrimResultsNew&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                     <span class=\"s1\">&#39;UseText&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">},</span> <span class=\"p\">{</span>\n                        <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;DeletePastClipboard&#39;</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;PastExpression&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;0&#39;</span><span class=\"p\">}</span>\n                    <span class=\"p\">],</span>\n                 <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482018934.65354</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;ModificationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482018953.856014</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"n\">name</span><span class=\"p\">,</span>\n                 <span class=\"s1\">&#39;Triggers&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"s1\">&#39;Case&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Exact&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;DiacriticalsMatter&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroTriggerType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;OnlyAfterWordBreak&#39;</span><span class=\"p\">:</span> <span class=\"bp\">False</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;SimulateDeletes&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_abbreviation</span><span class=\"p\">(</span><span class=\"n\">abbreviation</span><span class=\"p\">)}]}</span>\n            <span class=\"p\">],</span>\n            <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Snippet - </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">group_name</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">plaintext</span><span class=\"p\">(</span><span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;Activate&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Normal&#39;</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;Macros&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;Actions&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                <span class=\"p\">{</span>\n                    <span class=\"s1\">&#39;Action&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_paste_or_type</span><span class=\"p\">(</span><span class=\"s1\">&#39;plaintext&#39;</span><span class=\"p\">),</span>\n                    <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;InsertText&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;Paste&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;Text&#39;</span><span class=\"p\">:</span> <span class=\"n\">text</span><span class=\"p\">},</span> <span class=\"p\">{</span>\n                        <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;DeletePastClipboard&#39;</span><span class=\"p\">,</span>\n                        <span class=\"s1\">&#39;PastExpression&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;0&#39;</span>\n                    <span class=\"p\">}],</span>\n                <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;ModificationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482031702.132113</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"n\">name</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;Triggers&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"s1\">&#39;Case&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Exact&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;DiacriticalsMatter&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroTriggerType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;OnlyAfterWordBreak&#39;</span><span class=\"p\">:</span> <span class=\"bp\">False</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;SimulateDeletes&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_abbreviation</span><span class=\"p\">(</span><span class=\"n\">abbreviation</span><span class=\"p\">)}],</span>\n            <span class=\"p\">}],</span>\n            <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Snippet - </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">group_name</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">shell</span><span class=\"p\">(</span><span class=\"n\">group_name</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">text</span><span class=\"p\">,</span> <span class=\"n\">abbreviation</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;Activate&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Normal&#39;</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;Macros&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                <span class=\"s1\">&#39;Actions&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"s1\">&#39;DisplayKind&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_paste_or_type</span><span class=\"p\">(),</span>\n                    <span class=\"s1\">&#39;IncludeStdErr&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;ExecuteShellScript&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;Path&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;Text&#39;</span><span class=\"p\">:</span> <span class=\"n\">text</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TimeOutAbortsMacro&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TrimResults&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TrimResultsNew&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;UseText&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">},</span>\n                 <span class=\"p\">{</span><span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                  <span class=\"s1\">&#39;IsDisclosed&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                  <span class=\"s1\">&#39;MacroActionType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;DeletePastClipboard&#39;</span><span class=\"p\">,</span>\n                  <span class=\"s1\">&#39;PastExpression&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;0&#39;</span><span class=\"p\">}],</span>\n                <span class=\"s1\">&#39;CreationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482018896.698121</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;IsActive&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;ModificationDate&#39;</span><span class=\"p\">:</span> <span class=\"mf\">482020783.300151</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"n\">name</span><span class=\"p\">,</span>\n                <span class=\"s1\">&#39;Triggers&#39;</span><span class=\"p\">:</span> <span class=\"p\">[{</span>\n                    <span class=\"s1\">&#39;Case&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Exact&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;DiacriticalsMatter&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;MacroTriggerType&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;OnlyAfterWordBreak&#39;</span><span class=\"p\">:</span> <span class=\"bp\">False</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;SimulateDeletes&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n                    <span class=\"s1\">&#39;TypedString&#39;</span><span class=\"p\">:</span> <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">_abbreviation</span><span class=\"p\">(</span><span class=\"n\">abbreviation</span><span class=\"p\">)}],</span>\n                <span class=\"p\">}],</span>\n            <span class=\"s1\">&#39;Name&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Snippet - </span><span class=\"si\">%s</span><span class=\"s1\">&#39;</span> <span class=\"o\">%</span> <span class=\"n\">group_name</span><span class=\"p\">,</span>\n        <span class=\"p\">}</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_abbreviation</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">OPTIONAL_NEW_PREFIX</span> <span class=\"o\">+</span> <span class=\"n\">name</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_paste_or_type</span><span class=\"p\">(</span><span class=\"n\">snippet_type</span><span class=\"o\">=</span><span class=\"bp\">None</span><span class=\"p\">):</span>\n        <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"s1\">&#39;paste&#39;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Pasting&quot;</span><span class=\"p\">,</span>\n            <span class=\"s1\">&#39;type&#39;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Typing&quot;</span>\n        <span class=\"p\">}</span>\n        <span class=\"k\">if</span> <span class=\"n\">snippet_type</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;plaintext&#39;</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"s2\">&quot;By</span><span class=\"si\">%s</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">value</span><span class=\"p\">[</span><span class=\"n\">PASTE_OR_TYPE</span><span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"n\">value</span><span class=\"p\">[</span><span class=\"n\">PASTE_OR_TYPE</span><span class=\"p\">]</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">parse_textexpander</span><span class=\"p\">():</span>\n    <span class=\"sd\">&#39;&#39;&#39;</span>\n<span class=\"sd\">    Each TextExpander group is its own file starting with the file name &#39;group_&#39;.</span>\n\n<span class=\"sd\">    Example snippet dictionary</span>\n<span class=\"sd\">    {</span>\n<span class=\"sd\">        &#39;abbreviation&#39;: &#39;.bimg&#39;,</span>\n<span class=\"sd\">        &#39;abbreviationMode&#39;: 0,</span>\n<span class=\"sd\">        &#39;creationDate&#39;: datetime.datetime(2013, 5, 19, 19, 42, 16),</span>\n<span class=\"sd\">        &#39;label&#39;: &#39;&#39;,</span>\n<span class=\"sd\">        &#39;modificationDate&#39;: datetime.datetime(2015, 1, 10, 20, 19, 59),</span>\n<span class=\"sd\">        &#39;plainText&#39;: &#39;some text,</span>\n<span class=\"sd\">        &#39;snippetType&#39;: 3,</span>\n<span class=\"sd\">        &#39;uuidString&#39;: &#39;100F8D1F-A2D1-4313-8B55-EFD504AE7894&#39;</span>\n<span class=\"sd\">    }</span>\n\n<span class=\"sd\">    Return a list of dictionaries where the keys are the name of the group</span>\n<span class=\"sd\">    &#39;&#39;&#39;</span>\n    <span class=\"n\">to_ret</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n    <span class=\"c1\"># Let&#39;s get all the xml group files in the directory</span>\n    <span class=\"n\">xml_files</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">f</span> <span class=\"k\">for</span> <span class=\"n\">f</span> <span class=\"ow\">in</span> <span class=\"n\">glob</span><span class=\"o\">.</span><span class=\"n\">glob</span><span class=\"p\">(</span><span class=\"n\">TEXTEXPANDER_PATH</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;/*.xml&quot;</span><span class=\"p\">)</span>\n                 <span class=\"k\">if</span> <span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">startswith</span><span class=\"p\">(</span><span class=\"n\">TEXTEXPANDER_PATH</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;/group_&quot;</span><span class=\"p\">)]</span>\n\n    <span class=\"k\">for</span> <span class=\"n\">xml_file</span> <span class=\"ow\">in</span> <span class=\"n\">xml_files</span><span class=\"p\">:</span>\n        <span class=\"n\">pl</span> <span class=\"o\">=</span> <span class=\"n\">plistlib</span><span class=\"o\">.</span><span class=\"n\">readPlist</span><span class=\"p\">(</span><span class=\"n\">xml_file</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">pl</span><span class=\"p\">[</span><span class=\"s1\">&#39;name&#39;</span><span class=\"p\">]</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">to_ret</span><span class=\"p\">:</span>\n            <span class=\"n\">to_ret</span><span class=\"p\">[</span><span class=\"n\">pl</span><span class=\"p\">[</span><span class=\"s1\">&#39;name&#39;</span><span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"k\">for</span> <span class=\"n\">snippet</span> <span class=\"ow\">in</span> <span class=\"n\">pl</span><span class=\"p\">[</span><span class=\"s1\">&#39;snippetPlists&#39;</span><span class=\"p\">]:</span>\n            <span class=\"k\">if</span> <span class=\"n\">snippet</span><span class=\"p\">[</span><span class=\"s1\">&#39;snippetType&#39;</span><span class=\"p\">]</span> <span class=\"ow\">in</span> <span class=\"n\">snippet_types</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">():</span>\n                <span class=\"n\">to_ret</span><span class=\"p\">[</span><span class=\"n\">pl</span><span class=\"p\">[</span><span class=\"s1\">&#39;name&#39;</span><span class=\"p\">]]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">snippet</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">to_ret</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">text_expanders</span> <span class=\"o\">=</span> <span class=\"n\">parse_textexpander</span><span class=\"p\">()</span>\n    <span class=\"k\">for</span> <span class=\"n\">group</span><span class=\"p\">,</span> <span class=\"n\">text_expander</span> <span class=\"ow\">in</span> <span class=\"n\">text_expanders</span><span class=\"o\">.</span><span class=\"n\">iteritems</span><span class=\"p\">():</span>\n        <span class=\"n\">macros_to_create</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"k\">for</span> <span class=\"n\">snippet</span> <span class=\"ow\">in</span> <span class=\"n\">text_expander</span><span class=\"p\">:</span>\n            <span class=\"n\">macros_to_create</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n                <span class=\"n\">KeyboardMaestroMacros</span><span class=\"o\">.</span><span class=\"n\">macro_by_name</span><span class=\"p\">(</span><span class=\"n\">snippet_types_to_values</span><span class=\"p\">[</span><span class=\"n\">snippet</span><span class=\"p\">[</span><span class=\"s1\">&#39;snippetType&#39;</span><span class=\"p\">]],</span>\n                                                    <span class=\"n\">group</span><span class=\"p\">,</span>\n                                                    <span class=\"n\">snippet</span><span class=\"p\">[</span><span class=\"s1\">&#39;label&#39;</span><span class=\"p\">],</span>\n                                                    <span class=\"n\">snippet</span><span class=\"p\">[</span><span class=\"s1\">&#39;plainText&#39;</span><span class=\"p\">],</span>\n                                                    <span class=\"n\">snippet</span><span class=\"p\">[</span><span class=\"s1\">&#39;abbreviation&#39;</span><span class=\"p\">])</span>\n                <span class=\"p\">)</span>\n\n        <span class=\"c1\"># Create a new folder on the desktop to put the macros</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">exists</span><span class=\"p\">(</span><span class=\"n\">SAVE_PATH</span><span class=\"p\">):</span>\n            <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">mkdir</span><span class=\"p\">(</span><span class=\"n\">SAVE_PATH</span><span class=\"p\">)</span>\n        <span class=\"c1\"># Save the macros</span>\n        <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">SAVE_PATH</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;/</span><span class=\"si\">%s</span><span class=\"s1\">.kmmacros&#39;</span> <span class=\"o\">%</span> <span class=\"n\">group</span><span class=\"p\">,</span> <span class=\"s1\">&#39;w&#39;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n            <span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"n\">plistlib</span><span class=\"o\">.</span><span class=\"n\">writePlistToString</span><span class=\"p\">(</span><span class=\"n\">macros_to_create</span><span class=\"p\">))</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"n\">main</span><span class=\"p\">()</span>\n</code></pre></div>\n\n<p>Feedback and pull requests welcome. I'll continue to update the script and this post if I make any substantial iterations.</p>\n<div class=\"footnote\">\n<hr />\n<ol>\n<li id=\"fn:1\">\n<p>Hint. If you had your date look like 2016-04-10, the Keyboard Maestro equivalent is <code>%ICUDateTime%yyyy-MM-dd%</code>&#160;<a class=\"footnote-backref\" href=\"#fnref:1\" title=\"Jump back to footnote 1 in the text\">&#8617;</a></p>\n</li>\n</ol>\n</div>",
            "summary": "<p>I've been a long time TextExpander user. I use it every day for simple things like pasting my contact info or shortening urls using bit.ly. There are plenty of articles out there arguing for and against TextExpander's new subscription model. I support their decision but I can't justify $50 a year's worth of value and so I'm moving all of my snippets to Keyboard Maestro.</p>\n",
            "date_published": "2016-04-10T17:26:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "automation",
                "textexpander",
                "python",
                "keyboardmaestro"
            ]
        },
        {
            "id": "https://ryanmo.co/2015/10/24/using-contactsapp-with-textexpander-v2-objective-c-and-javascript",
            "url": "https://ryanmo.co/2015/10/24/using-contactsapp-with-textexpander-v2-objective-c-and-javascript",
            "title": "Using Contacts.app with TextExpander v2: Objective-C and JavaScript",
            "content_html": "\n<p>I was generally happy with how I was using <a href=\"{static}../2015-08-23/2015-08-23_Using-Contacts.app-with-TextExpander.md\">Contacts.app with TextExpander</a> to create snippets for my emails, phone numbers and addresses. However, as I eventually realized, I have to have Contacts.app running for it to work. When AppleScript and JavaScript talk to applications in OS X, they have to be running. That isn't the case for C and Objective-C libraries, so I decided to see how hard it was to use the Objective-C bindings for Javascript.</p>\n\n\n<p>The documentation is just as sparse in <a href=\"https://developer.apple.com/library/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/Articles/OSX10-10.html#//apple_ref/doc/uid/TP40014508-CH109-SW1\">the developer documentation</a>, however <a href=\"http://tylergaw.com/articles/building-osx-apps-with-js\">this article</a> by Tyler Gaw helped get me started in understanding how to represent Objective-C methods in Javascript. It's probably easiest to just show the script and explain what's going on.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">ObjC</span><span class=\"p\">.</span><span class=\"k\">import</span><span class=\"p\">(</span><span class=\"s2\">&quot;AddressBook&quot;</span><span class=\"p\">);</span>\n<span class=\"nx\">sAB</span> <span class=\"o\">=</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">ABAddressBook</span><span class=\"p\">.</span><span class=\"nx\">sharedAddressBook</span>\n<span class=\"nx\">meRecord</span> <span class=\"o\">=</span> <span class=\"nx\">sAB</span><span class=\"p\">.</span><span class=\"nx\">me</span>\n\n<span class=\"kd\">var</span> <span class=\"nx\">propertyToObjCType</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;email&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABEmailProperty</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;address&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABAddressProperty</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;phone&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABPhoneProperty</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">var</span> <span class=\"nx\">labelToObjCType</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">&#39;work&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABWorkLabel</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;home&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABHomeLabel</span><span class=\"p\">,</span>\n    <span class=\"s1\">&#39;iPhone&#39;</span><span class=\"o\">:</span> <span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">kABPhoneiPhoneLabel</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">valueForProperty</span><span class=\"p\">(</span><span class=\"nx\">property</span><span class=\"p\">){</span>\n    <span class=\"k\">return</span> <span class=\"nx\">meRecord</span><span class=\"p\">.</span><span class=\"nx\">valueForProperty</span><span class=\"p\">(</span><span class=\"nx\">propertyToObjCType</span><span class=\"p\">[</span><span class=\"nx\">property</span><span class=\"p\">])</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">getEmailByLabel</span><span class=\"p\">(</span><span class=\"nx\">inputLabel</span><span class=\"p\">){</span>\n    <span class=\"nx\">emails</span> <span class=\"o\">=</span> <span class=\"nx\">valueForProperty</span><span class=\"p\">(</span><span class=\"s1\">&#39;email&#39;</span><span class=\"p\">)</span>\n    <span class=\"nx\">label</span> <span class=\"o\">=</span> <span class=\"nx\">labelToObjCType</span><span class=\"p\">[</span><span class=\"nx\">inputLabel</span><span class=\"p\">]</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mf\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">emails</span><span class=\"p\">.</span><span class=\"nx\">count</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">){</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">CFEqual</span><span class=\"p\">(</span><span class=\"nx\">emails</span><span class=\"p\">.</span><span class=\"nx\">labelAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span> <span class=\"nx\">label</span><span class=\"p\">)){</span>\n            <span class=\"k\">return</span> <span class=\"nx\">emails</span><span class=\"p\">.</span><span class=\"nx\">valueAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">getAddressByLabel</span><span class=\"p\">(</span><span class=\"nx\">inputLabel</span><span class=\"p\">){</span>\n    <span class=\"nx\">addresses</span> <span class=\"o\">=</span> <span class=\"nx\">valueForProperty</span><span class=\"p\">(</span><span class=\"s1\">&#39;address&#39;</span><span class=\"p\">)</span>\n    <span class=\"nx\">label</span> <span class=\"o\">=</span> <span class=\"nx\">labelToObjCType</span><span class=\"p\">[</span><span class=\"nx\">inputLabel</span><span class=\"p\">]</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mf\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">addresses</span><span class=\"p\">.</span><span class=\"nx\">count</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">){</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">CFEqual</span><span class=\"p\">(</span><span class=\"nx\">addresses</span><span class=\"p\">.</span><span class=\"nx\">labelAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span> <span class=\"nx\">label</span><span class=\"p\">)){</span>\n            <span class=\"k\">return</span> <span class=\"nx\">sAB</span><span class=\"p\">.</span><span class=\"nx\">formattedAddressFromDictionary</span><span class=\"p\">(</span><span class=\"nx\">addresses</span><span class=\"p\">.</span><span class=\"nx\">valueAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">)).</span><span class=\"nx\">string</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">getPhoneByLabel</span><span class=\"p\">(</span><span class=\"nx\">inputLabel</span><span class=\"p\">){</span>\n    <span class=\"nx\">phone</span> <span class=\"o\">=</span> <span class=\"nx\">valueForProperty</span><span class=\"p\">(</span><span class=\"s1\">&#39;phone&#39;</span><span class=\"p\">)</span>\n    <span class=\"nx\">label</span> <span class=\"o\">=</span> <span class=\"nx\">labelToObjCType</span><span class=\"p\">[</span><span class=\"nx\">inputLabel</span><span class=\"p\">]</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mf\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">phone</span><span class=\"p\">.</span><span class=\"nx\">count</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">){</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">$</span><span class=\"p\">.</span><span class=\"nx\">CFEqual</span><span class=\"p\">(</span><span class=\"nx\">phone</span><span class=\"p\">.</span><span class=\"nx\">labelAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span> <span class=\"nx\">label</span><span class=\"p\">)){</span>\n            <span class=\"k\">return</span> <span class=\"nx\">phone</span><span class=\"p\">.</span><span class=\"nx\">valueAtIndex</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">)</span>\n        <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p>The biggest thing to point out is that if you have a method called in Objective-C like <code>[ABAddressBook sharedAddressBook];</code>, this gets converted to dot notation <code>$.ABAddressBook.sharedAddressBook</code>. The Obj-C bridge is always called with either <code>ObjC.</code> or <code>$.</code> followed by the method.</p>\n<p>You can find a nice list of different properties and values for the address book <a href=\"http://www.macdevcenter.com/pub/a/mac/2002/08/27/cocoa.html?page=2\">here</a>. For labels, the most common will be <code>$.kABHomeLabel</code> and <code>$.kABWorkLabel</code> for home and work respectively. If you've created a custom label (let's call it XXX), you can reference it by calling <code>$.kABXXXLabel</code>.</p>\n<p>As with any other JavaScript snippet in TextExpander, you can call any of these functions to expand the contact information that you'd like.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">getEmailByLabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;home&#39;</span><span class=\"p\">)</span>  <span class=\"c1\">// returns your home phone number</span>\n\n<span class=\"nx\">getAddressByLabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;work&#39;</span><span class=\"p\">)</span>  <span class=\"c1\">// returns your work address</span>\n\n<span class=\"nx\">getAddressByLabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;iPhone&#39;</span><span class=\"p\">)</span>  <span class=\"c1\">// returns your phone number labeled iPhone</span>\n</code></pre></div>\n\n<p>For those of you who don't like copy/pasting the same code over and over, there's a nice little hack that you can do in TextExpander.</p>\n<p>First, create a new Plain Text snippet with the code from the top of the post. I called the snippet \"getInfoFromContacts\". Once that's done, you can create new snippets that take advantage of this code by creating new JavaScript snippets with the following:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"o\">%</span><span class=\"nx\">snippet</span><span class=\"o\">:</span><span class=\"nx\">getInfoFromContacts</span><span class=\"o\">%</span>\n<span class=\"nx\">getEmailByLabel</span><span class=\"p\">(</span><span class=\"s1\">&#39;home&#39;</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>This way, if you update something from the main part of the code, you don't have to update all of your TextExpanders.</p>",
            "summary": "\n<p>I was generally happy with how I was using <a href=\"{static}../2015-08-23/2015-08-23_Using-Contacts.app-with-TextExpander.md\">Contacts.app with TextExpander</a> to create snippets for my emails, phone numbers and addresses. However, as I eventually realized, I have to have Contacts.app running for it to work. When AppleScript and JavaScript talk to applications in OS X, they have to be running. That isn't the case for C and Objective-C libraries, so I decided to see how hard it was to use the Objective-C bindings for Javascript.</p>\n",
            "date_published": "2015-10-24T02:12:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "textexpander",
                "automation",
                "javascript",
                "objectivec"
            ]
        },
        {
            "id": "https://ryanmo.co/2015/08/23/using-contactsapp-with-textexpander",
            "url": "https://ryanmo.co/2015/08/23/using-contactsapp-with-textexpander",
            "title": "Using Contacts.app with TextExpander",
            "content_html": "<p>Changing your email or phone number isn't fun. You have to tell everyone, update all of your online accounts, and make sure your TextExpanders are up-to-date with the right information. One of the places I will always update is my contact information in Contacts.app, so why not just use that as the source of truth for TextExpander snippets?</p>\n\n\n<p>In TextExpander 5, you can now use Javascript in snippets. Since I had <a href=\"{static}../2014-12-14/2014-12-14_backup-your-contacts-v2.md\">already created some scripts</a> using Contacts, I re-used some of the bits to create TextExpander snippets to expand information directly from Contacts.app.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">Contacts</span> <span class=\"o\">=</span> <span class=\"nx\">Application</span><span class=\"p\">(</span><span class=\"s1\">&#39;/Applications/Contacts.app&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\">// ::attr is the attribute you want pull (emails, phones, etc.)</span>\n<span class=\"c1\">// ::accountType is what you see to the left of the info in Contacts.app</span>\n<span class=\"kd\">function</span> <span class=\"nx\">getMyInfo</span><span class=\"p\">(</span><span class=\"nx\">attr</span><span class=\"p\">,</span> <span class=\"nx\">accountType</span><span class=\"p\">){</span>\n    <span class=\"nx\">method</span> <span class=\"o\">=</span> <span class=\"nx\">attr</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;addresses&#39;</span> <span class=\"o\">?</span> <span class=\"s1\">&#39;formattedAddress&#39;</span> <span class=\"o\">:</span> <span class=\"s1\">&#39;value&#39;</span>\n    <span class=\"nx\">search</span> <span class=\"o\">=</span> <span class=\"nx\">Contacts</span><span class=\"p\">.</span><span class=\"nx\">myCard</span><span class=\"p\">()[</span><span class=\"nx\">attr</span><span class=\"p\">].</span><span class=\"nx\">where</span><span class=\"p\">({</span><span class=\"nx\">label</span><span class=\"o\">:</span> <span class=\"nx\">accountType</span><span class=\"p\">})</span>\n    <span class=\"nx\">results</span> <span class=\"o\">=</span> <span class=\"nx\">search</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">?</span> <span class=\"nx\">search</span><span class=\"p\">().</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">a</span><span class=\"p\">){</span><span class=\"k\">return</span> <span class=\"nx\">a</span><span class=\"p\">[</span><span class=\"nx\">method</span><span class=\"p\">]()})</span> <span class=\"o\">:</span> <span class=\"p\">[]</span>\n\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">results</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">==</span> <span class=\"mf\">1</span><span class=\"p\">){</span>\n        <span class=\"k\">return</span> <span class=\"nx\">results</span><span class=\"p\">[</span><span class=\"mf\">0</span><span class=\"p\">]</span>\n    <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">results</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">&gt;</span> <span class=\"mf\">1</span><span class=\"p\">){</span>\n        <span class=\"k\">return</span> <span class=\"nx\">results</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"s2\">&quot;, &quot;</span><span class=\"p\">)</span>\n    <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"k\">return</span> <span class=\"s2\">&quot;&quot;</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"c1\">// Grab my &#39;blog&#39; email address </span>\n<span class=\"nx\">getMyInfo</span><span class=\"p\">(</span><span class=\"s1\">&#39;emails&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;blog&#39;</span><span class=\"p\">)</span> <span class=\"c1\">// returns email address</span>\n</code></pre></div>\n\n<p>The <code>getMyInfo</code> function is fairly generalized to allow you to get any basic information like emails or phone numbers from your contacts. The first argument is the type<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup>, and the second is the label you want, such as Home, Work, etc. To get a phone number, just change the function called to <code>getMyInfo('phones', 'iPhone)</code>. To get an address, change to <code>getMyInfo('addresses', 'home')</code>, which will return a formatted address.</p>\n<p><em>Update 2015-08-23</em>: Updated the <code>getMyInfo</code> function to support addresses.  </p>\n<p><em>Update 2015-09-20</em>: For a while, I couldn't figure out why occasionally expanding things from Contacts would take a little while. Then I realized, for AppleScript to work, the application you're calling needs to be open. If you do want to use this as a way to expand your information from Contacts, just know that you'll need to be running the application for the TextExpander snippets to work.</p>\n<p><em>Update 2015-09-20</em>: I've figured out a way to do this without Contacts.app running! Check out my post <a href=\"{static}../2015-10-24/2015-10-24-Using_Contacts_TextExpander_v2.md\">here</a> for more info.</p>\n<div class=\"footnote\">\n<hr />\n<ol>\n<li id=\"fn:1\">\n<p>You can find all the attributes in the Contacts.app scripts library in Address Book Script Suite \u2192 Application \u2192 myCard&#160;<a class=\"footnote-backref\" href=\"#fnref:1\" title=\"Jump back to footnote 1 in the text\">&#8617;</a></p>\n</li>\n</ol>\n</div>",
            "summary": "<p>Changing your email or phone number isn't fun. You have to tell everyone, update all of your online accounts, and make sure your TextExpanders are up-to-date with the right information. One of the places I will always update is my contact information in Contacts.app, so why not just use that as the source of truth for TextExpander snippets?</p>\n",
            "date_published": "2015-08-23T11:41:00-07:00",
            "date_modified": "2015-09-20T14:08:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "textexpander",
                "automation",
                "javascript"
            ]
        },
        {
            "id": "https://ryanmo.co/2014/05/10/show-time-in-multiple-time-zones-with-textexpander",
            "url": "https://ryanmo.co/2014/05/10/show-time-in-multiple-time-zones-with-textexpander",
            "title": "Show Time in Multiple Time Zones with TextExpander",
            "content_html": "<p>I'm really bad at converting a time to other timezones. Now that the company I work for has offices in multiple countries, scheduling has become much more difficult. In an effort to eliminate the need for people to convert times themselves, I wrote a TextExpander snippet to take care of it for me.</p>\n\n\n<p>There are tons of tools out there that show you what time it is in other parts of the world. One thing that isn't as readily available is a quick way to tell me what time it would be in California if it's 3:00pm in Dublin. I decided to write a quick TextExpander snippet that would let me pick the time and then it would output the time in all of my chosen time zones. </p>\n<p>The first step is to choose the time zones that you want to appear. In my case, I chose the following since we have offices in these locations:</p>\n<ul>\n<li>Europe/Dublin</li>\n<li>America/Los_Angeles</li>\n<li>America/Chicago</li>\n</ul>\n<p>Now I need to convert a chosen time to all of these time zones. This can be done using the <code>date</code> command in bash. Here's a quick example to try in the Terminal:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"err\">TZ=Europe/Dublin date -jf &quot;%H:%M %z&quot; &quot;$(date &quot;+%H:%M %z&quot;)&quot; &quot;+%H:%M %Z&quot;</span>\n</code></pre></div>\n\n<ul>\n<li>TZ lets you choose the time zone for the <code>date</code> command</li>\n<li>-f tells <code>date</code> the format to expect for the input</li>\n<li>-j tells <code>date</code> to not change the date allowing the -f flag to convert a time</li>\n<li>\"$(date \"+%H:%M %z\")\" just gives the current date that looks like HH:MM +0100</li>\n<li>\"+%H:%M %Z\" is the output format</li>\n</ul>\n<p>This gives you the following result:</p>\n<p>04:52 IST</p>\n<p>Now to do this for multiple time zones:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nv\">timezones</span><span class=\"o\">=(</span> <span class=\"s2\">&quot;America/Los_Angeles&quot;</span> <span class=\"s2\">&quot;America/Chicago&quot;</span> <span class=\"s2\">&quot;Europe/Dublin&quot;</span><span class=\"o\">)</span>\n\n<span class=\"k\">for</span> zone <span class=\"k\">in</span> <span class=\"si\">${</span><span class=\"nv\">timezones</span><span class=\"p\">[@]</span><span class=\"si\">}</span>\n<span class=\"k\">do</span>\n    <span class=\"nv\">TZ</span><span class=\"o\">=</span><span class=\"nv\">$zone</span> date -jf <span class=\"s2\">&quot;%H:%M %z&quot;</span> <span class=\"s2\">&quot;</span><span class=\"k\">$(</span>date <span class=\"s2\">&quot;+%H:%M %z&quot;</span><span class=\"k\">)</span><span class=\"s2\">&quot;</span> <span class=\"s2\">&quot;+%H:%M %Z&quot;</span><span class=\"p\">;</span>\n<span class=\"k\">done</span>\n</code></pre></div>\n\n<p>Which gives:</p>\n<p>08:55 PDT<br />\n10:55 CDT<br />\n16:55 IST  </p>\n<p>Lastly, let's add in some TextExpander input methods, and we have a way to use this with whatever time we want:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"ch\">#! /bin/bash</span>\n\n/* \nEnter a <span class=\"nb\">time</span> using 24H. <span class=\"m\">1</span>:30pm is <span class=\"m\">13</span>:30\n*/\n<span class=\"nv\">ENTERTIME</span><span class=\"o\">=</span><span class=\"s2\">&quot;%filltext:name=Hour:width=2%:%filltext:name=Minute:width=2%&quot;</span>\n\n<span class=\"nv\">timezones</span><span class=\"o\">=(</span> <span class=\"s2\">&quot;America/Los_Angeles&quot;</span> <span class=\"s2\">&quot;America/Chicago&quot;</span> <span class=\"s2\">&quot;Europe/Dublin&quot;</span> <span class=\"o\">)</span>\n\n<span class=\"k\">for</span> zone <span class=\"k\">in</span> <span class=\"si\">${</span><span class=\"nv\">timezones</span><span class=\"p\">[@]</span><span class=\"si\">}</span>\n<span class=\"k\">do</span>\n        <span class=\"nv\">TZ</span><span class=\"o\">=</span><span class=\"nv\">$zone</span> date -jf <span class=\"s2\">&quot;%H:%M %z&quot;</span> <span class=\"s2\">&quot;</span><span class=\"nv\">$ENTERTIME</span><span class=\"s2\"> </span><span class=\"k\">$(</span>date <span class=\"s2\">&quot;+%z&quot;</span><span class=\"k\">)</span><span class=\"s2\">&quot;</span> <span class=\"s2\">&quot;+%H:%M %Z&quot;</span><span class=\"p\">;</span>\n<span class=\"k\">done</span>\n</code></pre></div>",
            "summary": "<p>I'm really bad at converting a time to other timezones. Now that the company I work for has offices in multiple countries, scheduling has become much more difficult. In an effort to eliminate the need for people to convert times themselves, I wrote a TextExpander snippet to take care of it for me.</p>\n",
            "date_published": "2014-05-10T00:00:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "bash",
                "automation",
                "textexpander"
            ]
        }
    ],
    "title": "ryanmo.co",
    "version": "https://jsonfeed.org/version/1"
}