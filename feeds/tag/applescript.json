{
    "author": {
        "name": "Ryan M"
    },
    "favicon": "https://ryanmo.co/images/favicon.png",
    "feed_url": "https://ryanmo.co/feeds/tag/applescript.json",
    "home_page_url": "https://ryanmo.co",
    "items": [
        {
            "id": "https://ryanmo.co/2017/08/30/create-multiple-tasks-in-omnifocus-on-ios",
            "url": "https://ryanmo.co/2017/08/30/create-multiple-tasks-in-omnifocus-on-ios",
            "title": "Create Multiple Tasks in Omnifocus on iOS",
            "content_html": "<p>Throughout the day I think of things that I need to do after work or this coming weekend. The best way for me to not forget these is to quickly get them into Omnifocus. I've been using Drafts on my iPhone and Alfred on my Mac to quickly create tasks with the appropriate deferral and due dates. This has worked really well except for when I want to add more than one task at a time. </p>\n<p>Not too long ago, Omnifocus added the ability to import tasks in Taskpaper format. The import initially seemed very basic and only allowed you to dump them into Omnifocus' Inbox for processing. Digging into the documentation shows that you can be more specific about what project you want those tasks to go into as well as context, defer and due dates.</p>\n<p>Up until now, if I wanted to create multiple tasks for tonight, I would have to add each one individually in Drafts and use my \"Due Tonight\" action, return to Drafts and repeat. Using the Taskpaper syntax import, I can now add multiple lines as tasks in Drafts and import. Each line would look something like this:</p>\n<div class=\"codehilite\"><pre><span></span><code>- Take out the garbage @flagged(true) @context(Admin &amp; Routines) @defer(6pm) @due(8pm)\n- Finish blog post @flagged(true) @context(Admin &amp; Routines) @defer(6pm) @due(8pm)\n</code></pre></div>\n\n<p>Since Drafts supports JavaScript, I can create a single script to support my tonight, weekend or today tasks.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">targetTask</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;Todo&#39;</span><span class=\"p\">;</span>\n<span class=\"nx\">defaultTaskString</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;@flagged(true) @context(Admin &amp; Routines)&#39;</span><span class=\"p\">;</span>\n\n<span class=\"nx\">dueDateStrings</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"nx\">today</span><span class=\"o\">:</span> <span class=\"s1\">&#39;@defer(now) @due(5pm)&#39;</span><span class=\"p\">,</span>\n    <span class=\"nx\">tonight</span><span class=\"o\">:</span> <span class=\"s1\">&#39;@defer(6pm) @due(8pm)&#39;</span><span class=\"p\">,</span>\n    <span class=\"nx\">weekend</span><span class=\"o\">:</span> <span class=\"s1\">&#39;@defer(next saturday @ 10am) @due(next sunday @ 5pm)&#39;</span>\n<span class=\"p\">};</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">generateOmnifocusUrl</span><span class=\"p\">(</span><span class=\"nx\">params</span> <span class=\"o\">=</span> <span class=\"p\">{}){</span>\n    <span class=\"kd\">let</span> <span class=\"p\">{</span><span class=\"nx\">contentLines</span> <span class=\"o\">=</span> <span class=\"p\">[],</span> <span class=\"nx\">target</span> <span class=\"o\">=</span> <span class=\"nx\">targetTask</span><span class=\"p\">,</span> <span class=\"nx\">dueTime</span> <span class=\"o\">=</span> <span class=\"nx\">dueDateStrings</span><span class=\"p\">.</span><span class=\"nx\">today</span><span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"nx\">params</span><span class=\"p\">;</span>\n\n    <span class=\"nx\">contentLines</span><span class=\"p\">.</span><span class=\"nx\">forEach</span><span class=\"p\">((</span><span class=\"nx\">line</span><span class=\"p\">,</span> <span class=\"nx\">index</span><span class=\"p\">,</span> <span class=\"nx\">theArray</span><span class=\"p\">)</span> <span class=\"p\">=&gt;</span>\n        <span class=\"nx\">theArray</span><span class=\"p\">[</span><span class=\"nx\">index</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"sb\">`- </span><span class=\"si\">${</span><span class=\"nx\">line</span><span class=\"si\">}</span><span class=\"sb\"> </span><span class=\"si\">${</span><span class=\"nx\">dueTime</span><span class=\"si\">}</span><span class=\"sb\"> </span><span class=\"si\">${</span><span class=\"nx\">defaultTaskString</span><span class=\"si\">}</span><span class=\"sb\">`</span>\n    <span class=\"p\">);</span>\n    <span class=\"nx\">content</span> <span class=\"o\">=</span> <span class=\"nb\">encodeURIComponent</span><span class=\"p\">(</span><span class=\"nx\">contentLines</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"s1\">&#39;\\n&#39;</span><span class=\"p\">));</span>\n    <span class=\"k\">return</span> <span class=\"sb\">`omnifocus:///paste?target=/task/</span><span class=\"si\">${</span><span class=\"nx\">target</span><span class=\"si\">}</span><span class=\"sb\">&amp;content=</span><span class=\"si\">${</span><span class=\"nx\">content</span><span class=\"si\">}</span><span class=\"sb\">`</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"nx\">params</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"nx\">contentLines</span><span class=\"o\">:</span> <span class=\"nx\">draft</span><span class=\"p\">.</span><span class=\"nx\">content</span><span class=\"p\">.</span><span class=\"nx\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;\\n&#39;</span><span class=\"p\">),</span>\n    <span class=\"nx\">dueTime</span><span class=\"o\">:</span> <span class=\"nx\">dueDateStrings</span><span class=\"p\">[</span><span class=\"nx\">draft</span><span class=\"p\">.</span><span class=\"nx\">getTag</span><span class=\"p\">(</span><span class=\"s1\">&#39;taskWhen&#39;</span><span class=\"p\">)],</span>\n<span class=\"p\">}</span>\n\n<span class=\"nx\">draft</span><span class=\"p\">.</span><span class=\"nx\">defineTag</span><span class=\"p\">(</span><span class=\"s2\">&quot;OFTasks&quot;</span><span class=\"p\">,</span> <span class=\"nx\">generateOmnifocusUrl</span><span class=\"p\">(</span><span class=\"nx\">params</span><span class=\"p\">));</span>\n</code></pre></div>\n\n<p>The action will first prompt me asking whether these lines are for tonight, this weekend or today and will then create the TaskPaper lines and open Omnifocus.</p>\n<p><img alt=\"drafts-prompt\" src=\"https://ryanmo.co/posts/Tech/2017-08-30/drafts-prompt.png\" /></p>\n<p>You can download the action for Drafts <a href=\"https://drafts4-actions.agiletortoise.com/a/2Ex\">here</a>.</p>",
            "date_published": "2017-08-30T11:22:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "applescript",
                "automation",
                "ios",
                "javascript",
                "omnifocus"
            ]
        },
        {
            "id": "https://ryanmo.co/2017/01/23/syncing-photos-from-dropbox-to-the-photos-app-on-iphone",
            "url": "https://ryanmo.co/2017/01/23/syncing-photos-from-dropbox-to-the-photos-app-on-iphone",
            "title": "Syncing Photos from Dropbox to the Photos App on iPhone",
            "content_html": "<p>I've chosen to not use iCloud Photo Library for a few reasons. I have a decent system set up for storing my photos in Dropbox, but I've always wanted to have my photos local on my iPhone. Now that iOS 10 has some cool features like memories and image search, I've been looking for a way to have my photos on my iPhone and also in Dropbox.</p>\n\n\n<p>The easy solution is to simply point iTunes to your photo library in Dropbox and sync your photos over. This has a few downsides:</p>\n<ol>\n<li>If your photo library is large, you can't sync everything over</li>\n<li>iTunes doesn't let you sync multiple folders, so its all or nothing</li>\n<li>iTunes creates a thumbnail cache in the folder of photos, which means you have a large folder constantly syncing to Dropbox, which isn't ideal</li>\n</ol>\n<p>I already use Hazel to sort and organize my photos, so I figured adding another workflow would be fairly easy. On the computer where I sync my iPhone to iTunes, I set up a workflow that looks like this</p>\n<p><img alt=\"1\" src=\"https://ryanmo.co/posts/Tech/2017-01-23/1.png\" /></p>\n<p>Since my photo folder structure looks like [year]/[month]/[event], I need to look at each of the photos and then continue the workflow if it matches a matches a shell command</p>\n<p><img alt=\"2\" src=\"https://ryanmo.co/posts/Tech/2017-01-23/2.png\" /></p>\n<p>As long as what Hazel processes is a folder, and matches this regular expression, we can continue on to process the photos. This regular expression looks for a folder path that contains the the numbers 2015 through 2019<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup>. You can change the 5 to be whatever range you need, but I didn't need to go back to photos older than that.</p>\n<p>The next step is creating a hard link to the photo to a new folder I keep in <code>~/Pictures</code> called \"Photos for iPhone.\"</p>\n<p><img alt=\"3\" src=\"https://ryanmo.co/posts/Tech/2017-01-23/3.png\" /></p>\n<p>A hard link is nice here since it simply references the original file and doesn't take up space on your hard drive.</p>\n<p>Now I can point iTunes to my newly created folder. Each time a new photo gets added to my Dropbox photos folder, a new hard link is created and then synced to my iPhone the next time I plug it in.</p>\n<div class=\"footnote\">\n<hr />\n<ol>\n<li id=\"fn:1\">\n<p>This will stop working after 2019, but by that point, I'd hope that syncing and viewing photos will be in a better place.&#160;<a class=\"footnote-backref\" href=\"#fnref:1\" title=\"Jump back to footnote 1 in the text\">&#8617;</a></p>\n</li>\n</ol>\n</div>",
            "summary": "<p>I've chosen to not use iCloud Photo Library for a few reasons. I have a decent system set up for storing my photos in Dropbox, but I've always wanted to have my photos local on my iPhone. Now that iOS 10 has some cool features like memories and image search, I've been looking for a way to have my photos on my iPhone and also in Dropbox.</p>\n",
            "date_published": "2017-01-23T07:16:00-08:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "applescript",
                "javascript",
                "automation",
                "hazel"
            ]
        },
        {
            "id": "https://ryanmo.co/2015/06/06/filling-forms-with-pdfpen-and-javascript",
            "url": "https://ryanmo.co/2015/06/06/filling-forms-with-pdfpen-and-javascript",
            "title": "Filling Forms with PDFPen and Javascript",
            "content_html": "<p>My adventure with Mac Javascript Automation continues. Things still aren't easy and the documentation is poor, but I'm finding that it's still easier to write automation scripts in Javascript than it ever was with Applescript.</p>\n\n<p>Every month I need to fill out four receipts in a PDF form that I made with PDFPenPro. I never liked doing it and I felt like there had to be a way to do this better. I did some searching, and of course came across an <a href=\"http://leancrew.com/all-this/2012/02/automatic-w-9s-with-pdfpen\">old post</a> by Dr. Drang where he was adding rich text to PDFs. This was close to what I wanted, but since I had taken the time to create the form fields myself, I figured I should take advantage of them if I could.</p>\n<p>After some painful reading of the PDFPen Javascript library and playing around, I found that I was able to set the values of form fields if they had assigned names. I first went through the process of naming all of my form fields.</p>\n<p><img alt=\"formnames\" src=\"https://ryanmo.co/posts/Tech/2015-06-06/formnames.png\" /></p>\n<p>First we start with creating our app variable for PDFPen</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">app</span> <span class=\"o\">=</span> <span class=\"nx\">Application</span><span class=\"p\">(</span><span class=\"s2\">&quot;PdfPenPro&quot;</span><span class=\"p\">)</span>\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">includeStandardAdditions</span> <span class=\"o\">=</span> <span class=\"kc\">true</span><span class=\"p\">;</span>\n</code></pre></div>\n\n<p>After that, I created a few functions to easily set the values for text fields and buttons</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kd\">function</span> <span class=\"nx\">getFormField</span><span class=\"p\">(</span><span class=\"nx\">doc</span><span class=\"p\">,</span> <span class=\"nx\">field</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">formField</span> <span class=\"o\">=</span> <span class=\"nx\">doc</span><span class=\"p\">.</span><span class=\"nx\">pages</span><span class=\"p\">()[</span><span class=\"mf\">0</span><span class=\"p\">].</span><span class=\"nx\">imprints</span><span class=\"p\">.</span><span class=\"nx\">whose</span><span class=\"p\">({</span><span class=\"nx\">fieldName</span><span class=\"o\">:</span> <span class=\"nx\">field</span><span class=\"p\">})()</span>\n\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">formField</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"k\">return</span> <span class=\"nx\">formField</span><span class=\"p\">[</span><span class=\"mf\">0</span><span class=\"p\">]</span>\n    <span class=\"p\">}</span>\n    <span class=\"k\">return</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">setFormField</span><span class=\"p\">(</span><span class=\"nx\">doc</span><span class=\"p\">,</span> <span class=\"nx\">field</span><span class=\"p\">,</span> <span class=\"nx\">value</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">theField</span> <span class=\"o\">=</span> <span class=\"nx\">getFormField</span><span class=\"p\">(</span><span class=\"nx\">doc</span><span class=\"p\">,</span> <span class=\"nx\">field</span><span class=\"p\">)</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">theField</span><span class=\"p\">.</span><span class=\"kd\">class</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;button&quot;</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"nx\">theField</span><span class=\"p\">.</span><span class=\"nx\">checked</span> <span class=\"o\">=</span> <span class=\"nx\">value</span>\n    <span class=\"p\">}</span> <span class=\"k\">else</span> <span class=\"p\">{</span>\n        <span class=\"nx\">theField</span><span class=\"p\">.</span><span class=\"nx\">value</span> <span class=\"o\">=</span> <span class=\"nx\">value</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p>I've found that with PDFPen (or maybe more generally), keeping track of windows in applications with Javascript can get tricky. The order in which they appear can change, and so I've written myself a few helper functions to keep track of documents as I work through scripts.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kd\">var</span> <span class=\"nx\">getByName</span> <span class=\"o\">=</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">fileName</span><span class=\"p\">){</span>\n    <span class=\"k\">return</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">documents</span><span class=\"p\">.</span><span class=\"nx\">byName</span><span class=\"p\">(</span><span class=\"nx\">fileName</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n<span class=\"kd\">var</span> <span class=\"nx\">getDocPage</span> <span class=\"o\">=</span> <span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">fileName</span><span class=\"p\">,</span> <span class=\"nx\">pageNum</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"nx\">getByName</span><span class=\"p\">(</span><span class=\"nx\">fileName</span><span class=\"p\">).</span><span class=\"nx\">pages</span><span class=\"p\">[</span><span class=\"nx\">pageNum</span><span class=\"o\">-</span><span class=\"mf\">1</span><span class=\"p\">];</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p>These are helpful when I want to duplicate my template receipt that I've created and not run the risk of overwriting the original.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kd\">function</span> <span class=\"nx\">createNewReceipt</span><span class=\"p\">()</span> <span class=\"p\">{</span> \n    <span class=\"cm\">/*</span>\n<span class=\"cm\">        Opens the Receipt template</span>\n<span class=\"cm\">        Creates a new document and duplicates</span>\n<span class=\"cm\">        the template into the new doc</span>\n<span class=\"cm\">    */</span>\n    <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">open</span><span class=\"p\">(</span><span class=\"nx\">templatePath</span><span class=\"p\">)</span>\n    <span class=\"kd\">var</span> <span class=\"nx\">currentDoc</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">windows</span><span class=\"p\">[</span><span class=\"mf\">0</span><span class=\"p\">].</span><span class=\"nb\">document</span>\n    <span class=\"kd\">var</span> <span class=\"nx\">currentDocName</span> <span class=\"o\">=</span> <span class=\"nx\">currentDoc</span><span class=\"p\">.</span><span class=\"nx\">name</span><span class=\"p\">()</span>\n    <span class=\"nx\">doc</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">Document</span><span class=\"p\">().</span><span class=\"nx\">make</span><span class=\"p\">()</span>\n    <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">duplicate</span><span class=\"p\">(</span><span class=\"nx\">getDocPage</span><span class=\"p\">(</span><span class=\"nx\">currentDocName</span><span class=\"p\">,</span> <span class=\"mf\">1</span><span class=\"p\">),</span> <span class=\"p\">{</span><span class=\"nx\">to</span><span class=\"o\">:</span><span class=\"nx\">doc</span><span class=\"p\">})</span>\n    <span class=\"k\">return</span> <span class=\"nx\">doc</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n\n<p>At this point, it's simply a matter of filling in the fields however<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup> I like. I chose to have a few input fields and optional lists. Here are examples of both of those and how they can be implemented in Javascript.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"cm\">/*</span>\n<span class=\"cm\">    Creates a list to choose from where the options</span>\n<span class=\"cm\">    are an array called dateOptions.</span>\n<span class=\"cm\">    I always take the 0 element since I don&#39;t allow</span>\n<span class=\"cm\">    empty selections and multiples aren&#39;t allowed</span>\n<span class=\"cm\">*/</span>\n<span class=\"nx\">dateChoice</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">chooseFromList</span><span class=\"p\">(</span>\n                        <span class=\"nx\">dateOptions</span><span class=\"p\">,</span>\n                        <span class=\"p\">{</span><span class=\"nx\">withTitle</span><span class=\"o\">:</span> <span class=\"s2\">&quot;Start Date&quot;</span><span class=\"p\">,</span>\n                        <span class=\"nx\">withPrompt</span><span class=\"o\">:</span> <span class=\"s2\">&quot;Choose Start Date&quot;</span><span class=\"p\">,</span> \n                        <span class=\"nx\">defaultItems</span><span class=\"o\">:</span> <span class=\"nx\">dateOptions</span><span class=\"p\">[</span><span class=\"mf\">1</span><span class=\"p\">],</span>\n                        <span class=\"nx\">multipleSelectionsAllowed</span><span class=\"o\">:</span> <span class=\"kc\">false</span><span class=\"p\">,</span>\n                        <span class=\"nx\">emptySelectionAllowed</span><span class=\"o\">:</span> <span class=\"kc\">false</span><span class=\"p\">}</span>\n            <span class=\"p\">)[</span><span class=\"mf\">0</span><span class=\"p\">]</span>\n\n<span class=\"cm\">/* </span>\n<span class=\"cm\">    Basic dialog box. </span>\n<span class=\"cm\">    defaultAnswer has to exist, otherwise there</span>\n<span class=\"cm\">    won&#39;t be a text box to type into</span>\n<span class=\"cm\">*/</span>\n<span class=\"nx\">receivedFrom</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">displayDialog</span><span class=\"p\">(</span><span class=\"s2\">&quot;Who sent the check?&quot;</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"nx\">defaultAnswer</span><span class=\"o\">:</span> <span class=\"s2\">&quot;&quot;</span><span class=\"p\">})</span>\n</code></pre></div>\n\n<p>I then created an array of all the fields that I wanted to be filled.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">fieldsToFill</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n<span class=\"p\">{</span> <span class=\"nx\">value</span><span class=\"o\">:</span> <span class=\"nx\">receivedFrom</span><span class=\"p\">.</span><span class=\"nx\">textReturned</span><span class=\"p\">,</span> <span class=\"nx\">fieldName</span><span class=\"o\">:</span> <span class=\"s2\">&quot;ReceivedFrom&quot;</span> <span class=\"p\">},</span>\n    <span class=\"p\">...</span>\n<span class=\"p\">{</span> <span class=\"nx\">value</span><span class=\"o\">:</span> <span class=\"nx\">paymentType</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;Check&quot;</span> <span class=\"o\">?</span> <span class=\"kc\">true</span> <span class=\"o\">:</span> <span class=\"kc\">false</span><span class=\"p\">,</span> <span class=\"nx\">fieldName</span><span class=\"o\">:</span> <span class=\"s2\">&quot;CheckCheckBox&quot;</span> <span class=\"p\">}</span>\n<span class=\"p\">]</span>\n</code></pre></div>\n\n<p>The very last lines are where the magic happens and all the fields are filled out. It was pretty fun to watch the form fill almost instantly and then let me save it.</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"nx\">newDoc</span> <span class=\"o\">=</span> <span class=\"nx\">createNewReceipt</span><span class=\"p\">()</span>\n<span class=\"nx\">fieldsToFill</span><span class=\"p\">.</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">obj</span><span class=\"p\">){</span><span class=\"nx\">setFormField</span><span class=\"p\">(</span><span class=\"nx\">newDoc</span><span class=\"p\">,</span> <span class=\"nx\">obj</span><span class=\"p\">.</span><span class=\"nx\">fieldName</span><span class=\"p\">,</span> <span class=\"nx\">obj</span><span class=\"p\">.</span><span class=\"nx\">value</span><span class=\"p\">)})</span>\n\n<span class=\"nx\">saveLocation</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">chooseFileName</span><span class=\"p\">({</span><span class=\"nx\">defaultName</span><span class=\"o\">:</span> <span class=\"nx\">rentReceiptName</span><span class=\"p\">(</span><span class=\"nx\">dateChoice</span><span class=\"p\">),</span> <span class=\"nx\">defaultLocation</span><span class=\"o\">:</span> <span class=\"nx\">savePath</span><span class=\"p\">})</span>\n<span class=\"nx\">newDoc</span><span class=\"p\">.</span><span class=\"nx\">save</span><span class=\"p\">({</span><span class=\"k\">in</span><span class=\"o\">:</span> <span class=\"nx\">saveLocation</span><span class=\"p\">})</span>\n</code></pre></div>\n\n<p>That's it! This will take a lot of the slow process out of filling out my receipts each month. The next step will probably be generating the email and attaching the PDF. PDFPen already includes a script to do this very thing, so no more work needed for me. You can see the entire script <a href=\"https://gist.github.com/rjames86/8ee61652087a2c44802f\">here</a></p>\n<div class=\"footnote\">\n<hr />\n<ol>\n<li id=\"fn:1\">\n<p>I found <a href=\"https://github.com/dtinth/JXA-Cookbook/wiki/User-Interactions\">this resource</a> helpful to get me started on user input interactions&#160;<a class=\"footnote-backref\" href=\"#fnref:1\" title=\"Jump back to footnote 1 in the text\">&#8617;</a></p>\n</li>\n</ol>\n</div>",
            "summary": "<p>My adventure with Mac Javascript Automation continues. Things still aren't easy and the documentation is poor, but I'm finding that it's still easier to write automation scripts in Javascript than it ever was with Applescript.</p>\n",
            "date_published": "2015-06-06T04:15:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "automation",
                "javascript",
                "applescript"
            ]
        },
        {
            "id": "https://ryanmo.co/2015/01/25/save-first-page-of-pdf-for-expenses-with-hazel",
            "url": "https://ryanmo.co/2015/01/25/save-first-page-of-pdf-for-expenses-with-hazel",
            "title": "Save First Page of PDF for Expenses with Hazel",
            "content_html": "<p>Once a month I have to submit my Verizon bill as an expense. The process of getting the PDF of the bill and then modifying it turned out to be a big pain by first reminding my mom to send the bill<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup>, saving the first page and then submitting it for reimbursement. Turns out that Hazel can take care of everything beyond the actual submission.</p>\n\n<p>I'm fine with reminding my mom to put the PDF in Dropbox, but I then have to check back every-so-often to see if she's actually done it. I've created a rule now that will check for any files in our shared Verizon Bill folder and if Hazel hasn't seen it before, it will send me a push notification with Pushover.</p>\n<p><img alt=\"pushover_hazel_verizon\" src=\"https://ryanmo.co/posts/Tech/2015-01-25/pushover_hazel_verizon.png\" /></p>\n<p>I then wrote a handy little Applescript based on PDFPenPro's default script called Split PDFs that will take the first page of a PDF and save it to a new file. I differentiate the files by just adding \"SINGLE PAGE\" to the filename</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">set</span> <span class=\"nv\">basePath</span> <span class=\"k\">to</span> <span class=\"s2\">&quot;/path/to/verizon/folder&quot;</span>\n\n<span class=\"k\">tell</span> <span class=\"nb\">application</span> <span class=\"s2\">&quot;PDFpenPro&quot;</span>\n    <span class=\"nb\">open</span> <span class=\"nv\">theFile</span> <span class=\"k\">as</span> <span class=\"nv\">alias</span>\n    <span class=\"k\">set</span> <span class=\"nv\">originalDoc</span> <span class=\"k\">to</span> <span class=\"na\">document</span> <span class=\"mi\">1</span>\n    <span class=\"k\">set</span> <span class=\"nv\">docName</span> <span class=\"k\">to</span> <span class=\"na\">name</span> <span class=\"k\">of</span> <span class=\"nv\">originalDoc</span>\n\n    <span class=\"k\">if</span> <span class=\"nv\">docName</span> <span class=\"ow\">ends with</span> <span class=\"s2\">&quot;.pdf&quot;</span> <span class=\"k\">then</span>\n        <span class=\"k\">set</span> <span class=\"nv\">docNameLength</span> <span class=\"k\">to</span> <span class=\"p\">(</span><span class=\"nv\">length</span> <span class=\"k\">of</span> <span class=\"nv\">docName</span><span class=\"p\">)</span>\n        <span class=\"k\">set</span> <span class=\"nv\">docName</span> <span class=\"k\">to</span> <span class=\"p\">(</span><span class=\"nb\">characters</span> <span class=\"mi\">1</span> <span class=\"nb\">thru</span> <span class=\"p\">(</span><span class=\"nv\">docNameLength</span> <span class=\"o\">-</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"k\">of</span> <span class=\"nv\">docName</span> <span class=\"k\">as </span><span class=\"nc\">string</span><span class=\"p\">)</span>\n    <span class=\"k\">end</span> <span class=\"k\">if</span>\n\n\n    <span class=\"k\">set</span> <span class=\"nv\">newDoc</span> <span class=\"k\">to</span> <span class=\"nb\">make</span> <span class=\"nb\">new</span> <span class=\"na\">document</span>\n    <span class=\"k\">set</span> <span class=\"nv\">savePath</span> <span class=\"k\">to</span> <span class=\"p\">((</span><span class=\"nv\">basePath</span> <span class=\"k\">as</span> <span class=\"na\">rich text</span><span class=\"p\">)</span> <span class=\"o\">&amp;</span> <span class=\"nv\">docName</span> <span class=\"o\">&amp;</span> <span class=\"s2\">&quot; SINGLE PAGE&quot;</span> <span class=\"o\">&amp;</span> <span class=\"s2\">&quot;.pdf&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"nb\">copy</span> <span class=\"nv\">page</span> <span class=\"mi\">1</span> <span class=\"k\">of</span> <span class=\"nv\">originalDoc</span> <span class=\"k\">to</span> <span class=\"k\">end</span> <span class=\"k\">of</span> <span class=\"nv\">pages</span> <span class=\"k\">of</span> <span class=\"nv\">newDoc</span>\n\n    <span class=\"nv\">save</span> <span class=\"nv\">newDoc</span> <span class=\"k\">in</span> <span class=\"nv\">POSIX</span> <span class=\"nv\">file</span> <span class=\"nv\">savePath</span>\n\n    <span class=\"nb\">quit</span>\n<span class=\"k\">end</span> <span class=\"k\">tell</span>\n</code></pre></div>\n\n<p>Finally, so that I don't forget to submit the expense, I have one final Applescript that creates a todo item in Omnifocus based on David Spark's post <a href=\"http://macsparky.com/blog/2012/8/applescript-omnifocus-tasks\">here</a></p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">set</span> <span class=\"nv\">theDate</span> <span class=\"k\">to</span> <span class=\"nb\">current date</span>\n<span class=\"k\">set</span> <span class=\"nv\">deferDate</span> <span class=\"k\">to</span> <span class=\"p\">(</span><span class=\"nb\">current date</span><span class=\"p\">)</span>\n<span class=\"k\">set</span> <span class=\"nv\">dueDate</span> <span class=\"k\">to</span> <span class=\"p\">(</span><span class=\"nb\">current date</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"o\">*</span> <span class=\"nb\">days</span><span class=\"p\">)</span>\n<span class=\"k\">set</span> <span class=\"nv\">theTask</span> <span class=\"k\">to</span> <span class=\"s2\">&quot;Expense Verizon Bill&quot;</span>\n<span class=\"k\">set</span> <span class=\"nv\">theNote</span> <span class=\"k\">to</span> <span class=\"nv\">theFile</span>\n\n<span class=\"k\">tell</span> <span class=\"nb\">application</span> <span class=\"s2\">&quot;OmniFocus&quot;</span>\n    <span class=\"k\">tell</span> <span class=\"nb\">front</span> <span class=\"na\">document</span>\n        <span class=\"k\">set</span> <span class=\"nv\">theContext</span> <span class=\"k\">to</span> <span class=\"nb\">first</span> <span class=\"nv\">flattened</span> <span class=\"na\">context</span> <span class=\"nb\">where</span> <span class=\"k\">its</span> <span class=\"na\">name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;A Context&quot;</span>\n        <span class=\"k\">set</span> <span class=\"nv\">theProject</span> <span class=\"k\">to</span> <span class=\"nb\">first</span> <span class=\"nv\">flattened</span> <span class=\"nv\">project</span> <span class=\"nb\">where</span> <span class=\"k\">its</span> <span class=\"na\">name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;Expenses&quot;</span>\n        <span class=\"k\">tell</span> <span class=\"nv\">theProject</span> <span class=\"k\">to</span> <span class=\"nb\">make</span> <span class=\"nb\">new</span> <span class=\"nv\">task</span> <span class=\"nv\">with</span> <span class=\"na\">properties</span> <span class=\"p\">{</span><span class=\"na\">name</span><span class=\"p\">:</span><span class=\"nv\">theTask</span><span class=\"p\">,</span> <span class=\"nv\">note</span><span class=\"p\">:</span><span class=\"nv\">theNote</span><span class=\"p\">,</span> <span class=\"na\">context</span><span class=\"p\">:</span><span class=\"nv\">theContext</span><span class=\"p\">,</span> <span class=\"nv\">defer</span> <span class=\"nv\">date</span><span class=\"p\">:</span><span class=\"nv\">deferDate</span><span class=\"p\">,</span> <span class=\"nv\">due</span> <span class=\"nv\">date</span><span class=\"p\">:</span><span class=\"nv\">dueDate</span><span class=\"p\">}</span>\n    <span class=\"k\">end</span> <span class=\"k\">tell</span>\n<span class=\"k\">end</span> <span class=\"k\">tell</span>\n</code></pre></div>\n\n<div class=\"footnote\">\n<hr />\n<ol>\n<li id=\"fn:1\">\n<p>We're on a family plan&#160;<a class=\"footnote-backref\" href=\"#fnref:1\" title=\"Jump back to footnote 1 in the text\">&#8617;</a></p>\n</li>\n</ol>\n</div>",
            "summary": "<p>Once a month I have to submit my Verizon bill as an expense. The process of getting the PDF of the bill and then modifying it turned out to be a big pain by first reminding my mom to send the bill<sup id=\"fnref:1\"><a class=\"footnote-ref\" href=\"#fn:1\">1</a></sup>, saving the first page and then submitting it for reimbursement. Turns out that Hazel can take care of everything beyond the actual submission.</p>\n",
            "date_published": "2015-01-25T12:46:00-08:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "hazel",
                "applescript",
                "automation"
            ]
        },
        {
            "id": "https://ryanmo.co/2014/12/14/backup-your-contacts-v2-yosemites-javascript-automation",
            "url": "https://ryanmo.co/2014/12/14/backup-your-contacts-v2-yosemites-javascript-automation",
            "title": "Backup Your Contacts v2 : Yosemite\u2019s Javascript Automation",
            "content_html": "<p>I recently read MacStories' <a href=\"http://www.macstories.net/tutorials/getting-started-with-javascript-for-automation-on-yosemite/\">article</a> and was curious how easy this was to learn. Applescript never made sense to me and I spent more time trying to piece together examples than actually writing anything meaningful. I don't trust iCloud to keep my contacts safe, and I'm still using <a href=\"{static}../2014-09-28/2014-09-25_backup_contacts_with_pythonista.md\">my previous workflow</a> with <a href=\"http://contrast.co/launch-center-pro/\">Launch Center Pro</a> and <a href=\"http://omz-software.com/pythonista/\">Pythonista</a> to back up my contacts.</p>\n\n<p>My first attempt at the new JSX Automation was a script to back up my contacts, which would allow me to run this automatically on my Mac Mini server. Here is what the script looks like</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kd\">var</span> <span class=\"nx\">app</span> <span class=\"o\">=</span> <span class=\"nx\">Application</span><span class=\"p\">.</span><span class=\"nx\">currentApplication</span><span class=\"p\">()</span>\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">includeStandardAdditions</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n\n<span class=\"nx\">now</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">()</span>\n<span class=\"nx\">nowString</span> <span class=\"o\">=</span> <span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">getFullYear</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;-&quot;</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">getMonth</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"mf\">1</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;-&quot;</span> <span class=\"o\">+</span> <span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">getDate</span><span class=\"p\">()</span>\n\n<span class=\"c1\">// Replace outputFile with this if you want to automatically set the path</span>\n<span class=\"c1\">// var outputFile = Path(&#39;pick your path&#39;)  </span>\n<span class=\"kd\">var</span> <span class=\"nx\">outputFile</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">chooseFileName</span><span class=\"p\">({</span>\n    <span class=\"nx\">withPrompt</span><span class=\"o\">:</span> <span class=\"s2\">&quot;Pick where to save your vCard backup.&quot;</span><span class=\"p\">,</span>\n    <span class=\"nx\">defaultName</span><span class=\"o\">:</span> <span class=\"nx\">nowString</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;_backup.vcf&quot;</span>\n<span class=\"p\">})</span>\n\n<span class=\"kd\">var</span> <span class=\"nx\">a</span> <span class=\"o\">=</span> <span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">openForAccess</span><span class=\"p\">(</span><span class=\"nx\">outputFile</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"nx\">writePermission</span><span class=\"o\">:</span> <span class=\"kc\">true</span><span class=\"p\">})</span>\n<span class=\"nx\">Contacts</span> <span class=\"o\">=</span> <span class=\"nx\">Application</span><span class=\"p\">(</span><span class=\"s1\">&#39;/Applications/Contacts.app&#39;</span><span class=\"p\">)</span>\n<span class=\"nx\">contacts</span> <span class=\"o\">=</span> <span class=\"nx\">Contacts</span><span class=\"p\">.</span><span class=\"nx\">people</span><span class=\"p\">()</span>\n<span class=\"nx\">outputString</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;&#39;</span>\n\n<span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mf\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">contacts</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">){</span>\n  <span class=\"nx\">outputString</span> <span class=\"o\">+=</span> <span class=\"nx\">contacts</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">vcard</span><span class=\"p\">()</span>\n<span class=\"p\">}</span>\n\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">write</span><span class=\"p\">(</span><span class=\"nx\">outputString</span><span class=\"p\">,{</span>\n    <span class=\"nx\">to</span><span class=\"o\">:</span> <span class=\"nx\">a</span><span class=\"p\">,</span>\n    <span class=\"nx\">startingAt</span><span class=\"o\">:</span> <span class=\"mf\">0</span><span class=\"p\">,</span>\n    <span class=\"nx\">as</span><span class=\"o\">:</span><span class=\"s1\">&#39;text&#39;</span>\n<span class=\"p\">})</span>\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">closeAccess</span><span class=\"p\">(</span><span class=\"nx\">outputFile</span><span class=\"p\">)</span>\n\n<span class=\"nx\">app</span><span class=\"p\">.</span><span class=\"nx\">displayNotification</span><span class=\"p\">(</span><span class=\"s2\">&quot;Backup finished!&quot;</span><span class=\"p\">,{</span>\n    <span class=\"nx\">withTitle</span><span class=\"o\">:</span> <span class=\"s2\">&quot;Backup Contacts&quot;</span><span class=\"p\">,</span>\n    <span class=\"nx\">subtitle</span><span class=\"o\">:</span> <span class=\"nx\">contacts</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">+</span> <span class=\"s2\">&quot; contacts backed up.&quot;</span>\n<span class=\"p\">})</span>\n</code></pre></div>\n\n<p>The current script lets you choose the path to save the file. You can change this to have it be the same path every time if you want (see the instructions in the comments above).</p>\n<p>You can download the script <a href=\"https://ryanmo.co/2014/12/14/backup-your-contacts-v2-yosemites-javascript-automation/BackupContacts.zip\">here</a> to try it for yourself.</p>\n<p>Big thank you to Alex Guyot at MacStories for his introduction to Javascript Automation.</p>",
            "summary": "<p>I recently read MacStories' <a href=\"http://www.macstories.net/tutorials/getting-started-with-javascript-for-automation-on-yosemite/\">article</a> and was curious how easy this was to learn. Applescript never made sense to me and I spent more time trying to piece together examples than actually writing anything meaningful. I don't trust iCloud to keep my contacts safe, and I'm still using <a href=\"{static}../2014-09-28/2014-09-25_backup_contacts_with_pythonista.md\">my previous workflow</a> with <a href=\"http://contrast.co/launch-center-pro/\">Launch Center Pro</a> and <a href=\"http://omz-software.com/pythonista/\">Pythonista</a> to back up my contacts.</p>\n",
            "date_published": "2014-12-14T00:00:00-08:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "automation",
                "applescript",
                "javascript"
            ]
        },
        {
            "id": "https://ryanmo.co/2013/07/07/i18n_contacts",
            "url": "https://ryanmo.co/2013/07/07/i18n_contacts",
            "title": "Internationalizing Your Contacts",
            "content_html": "<p>Living in the U.S. we rarely call people outside of the country. Whenever we create new contacts in our address book, they'll typically start with the state's area code and omit the country code. </p>\n\n\n<p>Since moving to Ireland, my contacts wouldn't show up correctly since I hadn't prepended all of contacts with '+1'. I wasn't about to manually change all 700 contacts in my phone and fortunately came across a <a href=\"http://en.katzueno.com/2011/06/08/adding-1-to-us-tel-numbers-in-address-book-mac-os-x/\">nice post</a> that had the following AppleScript:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">tell</span> <span class=\"nb\">application</span> <span class=\"s2\">&quot;Address Book&quot;</span>\n    <span class=\"k\">repeat</span> <span class=\"nv\">with</span> <span class=\"nv\">eachPerson</span> <span class=\"k\">in</span> <span class=\"nv\">people</span>\n        <span class=\"k\">repeat</span> <span class=\"nv\">with</span> <span class=\"nv\">eachNumber</span> <span class=\"k\">in</span> <span class=\"nv\">phones</span> <span class=\"k\">of</span> <span class=\"nv\">eachPerson</span>\n            <span class=\"k\">set</span> <span class=\"nv\">theNum</span> <span class=\"k\">to</span> <span class=\"p\">(</span><span class=\"k\">get</span> <span class=\"nv\">value</span> <span class=\"k\">of</span> <span class=\"nv\">eachNumber</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nv\">theNum</span> <span class=\"ow\">does</span> <span class=\"ow\">not</span> <span class=\"ow\">start with</span> <span class=\"s2\">&quot;+&quot;</span> <span class=\"ow\">and</span> <span class=\"nv\">theNum</span> <span class=\"ow\">does</span> <span class=\"ow\">not</span> <span class=\"ow\">start with</span> <span class=\"s2\">&quot;1&quot;</span> <span class=\"ow\">and</span> <span class=\"nv\">theNum</span> <span class=\"ow\">does</span> <span class=\"ow\">not</span> <span class=\"ow\">start with</span> <span class=\"s2\">&quot;0&quot;</span><span class=\"p\">)</span> <span class=\"k\">then</span>\n                <span class=\"k\">set</span> <span class=\"nv\">value</span> <span class=\"k\">of</span> <span class=\"nv\">eachNumber</span> <span class=\"k\">to</span> <span class=\"s2\">&quot;+1&quot;</span> <span class=\"o\">&amp;</span> <span class=\"nv\">theNum</span>\n            <span class=\"k\">end</span> <span class=\"k\">if</span>\n        <span class=\"k\">end</span> <span class=\"k\">repeat</span>\n    <span class=\"k\">end</span> <span class=\"k\">repeat</span>\n    <span class=\"nv\">save</span>\n<span class=\"k\">end</span> <span class=\"k\">tell</span>\n</code></pre></div>\n\n<p>Before running this, I highly recommend backing up your contacts. This can be run easily by just launching AppleScript Editor and pasting in the code above. Enjoy!</p>",
            "summary": "<p>Living in the U.S. we rarely call people outside of the country. Whenever we create new contacts in our address book, they'll typically start with the state's area code and omit the country code. </p>\n",
            "date_published": "2013-07-07T00:00:00-07:00",
            "author": {
                "name": "Ryan M",
                "url": "https://ryanmo.co/author/ryan-m.html"
            },
            "tags": [
                "automation",
                "applescript"
            ]
        }
    ],
    "title": "ryanmo.co",
    "version": "https://jsonfeed.org/version/1"
}