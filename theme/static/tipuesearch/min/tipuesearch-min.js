!function($){$.fn.tipuesearch=function(e){var t=$.extend({show:7,newWindow:!1,showURL:!0,showTitleCount:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:"*",liveContent:"*",contentLocation:"tipuesearch/tipuesearch_content.json",debug:!1},e);return this.each(function(){function e(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function i(e,a){$("#tipue_search_content").hide(),$("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>'),$("#tipue_search_content").show();var h="",n="",o=!1,p=!1,u=!0,l=0;found=[];var _=$("#tipue_search_input").val().toLowerCase();if(_=$.trim(_),(_.match('^"')&&_.match('"$')||_.match("^'")&&_.match("'$"))&&(u=!1),u){var g=_.split(" ");_="";for(var d=0;d<g.length;d++){for(var v=!0,f=0;f<tipuesearch_stop_words.length;f++)g[d]==tipuesearch_stop_words[f]&&(v=!1,p=!0);v&&(_=_+" "+g[d])}_=$.trim(_),g=_.split(" ")}else _=_.substring(1,_.length-1);if(_.length>=t.minimumLength){if(u){if(a){for(var w=_,d=0;d<g.length;d++)for(var f=0;f<tipuesearch_replace.words.length;f++)g[d]==tipuesearch_replace.words[f].word&&(_=_.replace(g[d],tipuesearch_replace.words[f].replace_with),o=!0);g=_.split(" ")}for(var m=_,d=0;d<g.length;d++)for(var f=0;f<tipuesearch_stem.words.length;f++)g[d]==tipuesearch_stem.words[f].word&&(m=m+" "+tipuesearch_stem.words[f].stem);g=m.split(" ");for(var d=0;d<s.pages.length;d++){for(var x=0,b=s.pages[d].text,f=0;f<g.length;f++){var L=new RegExp(g[f],"gi");if(-1!=s.pages[d].title.search(L)){var E=s.pages[d].title.match(L).length;x+=20*E}if(-1!=s.pages[d].text.search(L)){var E=s.pages[d].text.match(L).length;x+=20*E}if(t.highlightTerms){if(t.highlightEveryTerm)var R=new RegExp("("+g[f]+")","gi");else var R=new RegExp("("+g[f]+")","i");b=b.replace(R,'<span class="h01">$1</span>')}if(-1!=s.pages[d].tags.search(L)){var E=s.pages[d].tags.match(L).length;x+=10*E}if(-1!=s.pages[d].url.search(L)&&(x+=20),0!=x)for(var C=0;C<tipuesearch_weight.weight.length;C++)s.pages[d].url==tipuesearch_weight.weight[C].url&&(x+=tipuesearch_weight.weight[C].score);g[f].match("^-")&&(L=new RegExp(g[f].substring(1),"i"),(-1!=s.pages[d].title.search(L)||-1!=s.pages[d].text.search(L)||-1!=s.pages[d].tags.search(L))&&(x=0))}0!=x&&(found.push({score:x,title:s.pages[d].title,desc:b,url:s.pages[d].url}),l++)}}else for(var d=0;d<s.pages.length;d++){var x=0,b=s.pages[d].text,L=new RegExp(_,"gi");if(-1!=s.pages[d].title.search(L)){var E=s.pages[d].title.match(L).length;x+=20*E}if(-1!=s.pages[d].text.search(L)){var E=s.pages[d].text.match(L).length;x+=20*E}if(t.highlightTerms){if(t.highlightEveryTerm)var R=new RegExp("("+_+")","gi");else var R=new RegExp("("+_+")","i");b=b.replace(R,'<span class="h01">$1</span>')}if(-1!=s.pages[d].tags.search(L)){var E=s.pages[d].tags.match(L).length;x+=10*E}if(-1!=s.pages[d].url.search(L)&&(x+=20),0!=x)for(var C=0;C<tipuesearch_weight.weight.length;C++)s.pages[d].url==tipuesearch_weight.weight[C].url&&(x+=tipuesearch_weight.weight[C].score);0!=x&&(found.push({score:x,title:s.pages[d].title,desc:b,url:s.pages[d].url}),l++)}if(0!=l){if(t.showTitleCount&&0==r){var y=document.title;document.title="("+l+") "+y,r++}1==o&&(h+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+_+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+w+"</a></div>"),1==l?h+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),h+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>"),found.sort(function(e,t){return t.score-e.score});for(var T=0,d=0;d<found.length;d++){if(T>=e&&T<t.show+e){if(h+='<div class="tipue_search_content_title"><a href="'+found[d].url+'"'+c+">"+found[d].title+"</a></div>",t.debug&&(h+='<div class="tipue_search_content_debug">Score: '+found[d].score+"</div>"),t.showURL){var k=found[d].url.toLowerCase();0==k.indexOf("http://")&&(k=k.slice(7)),h+='<div class="tipue_search_content_url"><a href="'+found[d].url+'"'+c+">"+k+"</a></div>"}if(found[d].desc){var W=found[d].desc,j="",q=W.split(" ");if(q.length<t.descriptiveWords)j=W;else for(var f=0;f<t.descriptiveWords;f++)j+=q[f]+" ";j=$.trim(j),"."!=j.charAt(j.length-1)&&(j+=" ..."),h+='<div class="tipue_search_content_text">'+j+"</div>"}}T++}if(l>t.show){var O=Math.ceil(l/t.show),S=e/t.show;if(h+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',e>0&&(h+='<li><a class="tipue_search_foot_box" id="'+(e-t.show)+"_"+a+'">'+tipuesearch_string_6+"</a></li>"),2>=S){var D=O;O>3&&(D=3);for(var f=0;D>f;f++)h+=f==S?'<li class="current">'+(f+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+f*t.show+"_"+a+'">'+(f+1)+"</a></li>"}else{var D=S+2;D>O&&(D=O);for(var f=S-1;D>f;f++)h+=f==S?'<li class="current">'+(f+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+f*t.show+"_"+a+'">'+(f+1)+"</a></li>"}S+1!=O&&(h+='<li><a class="tipue_search_foot_box" id="'+(e+t.show)+"_"+a+'">'+tipuesearch_string_7+"</a></li>"),h+="</ul></div>"}}else h+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>";window.tipue_search_results_count=l}else p?h+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(h+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",h+=1==t.minimumLength?'<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":'<div id="tipue_search_warning">'+tipuesearch_string_12+" "+t.minimumLength+" "+tipuesearch_string_13+"</div>");$("#tipue_search_content").hide(),$("#tipue_search_content").html(h),$("#tipue_search_content").slideDown(200),$("#tipue_search_replaced").click(function(){i(0,!1)}),$(".tipue_search_foot_box").click(function(){var e=$(this).attr("id"),t=e.split("_");i(parseInt(t[0]),t[1])})}var s={pages:[]};$.ajaxSetup({async:!1});var r=0;if("live"==t.mode)for(var a=0;a<tipuesearch_pages.length;a++)$.get(tipuesearch_pages[a]).done(function(e){var i=$(t.liveContent,e).text();i=i.replace(/\s+/g," ");var r=$(t.liveDescription,e).text();r=r.replace(/\s+/g," ");var c=e.toLowerCase().indexOf("<title>"),h=e.toLowerCase().indexOf("</title>",c+7);if(-1!=c&&-1!=h)var n=e.slice(c+7,h);else var n=tipuesearch_string_1;s.pages.push({title:n,text:r,tags:i,url:tipuesearch_pages[a]})});"json"==t.mode&&$.getJSON(t.contentLocation).done(function(e){s=$.extend({},e)}),"static"==t.mode&&(s=$.extend({},tipuesearch));var c="";t.newWindow&&(c=' target="_blank"'),e("q")&&($("#tipue_search_input").val(e("q")),i(0,!0),window.tipue_search_query=e("q")),$(this).keyup(function(e){"13"==e.keyCode&&i(0,!0)})})}}(jQuery);